{% extends 'base.html' %}
{% block content %}


<h2 class="title-text">Hikes</h2>

<div class="container">
	<div class="row">
		<div id="map" class="maps"></div>
	</div>
</div>

<div class="container">
	<ul>
		{% for hike in hikes %}
		<div class="row">
			<div class="col s12">
				<ul class="collapsible break" data-collapsible="accordian">
					<li>
						<div class="collapsible-header">
							<div class="col s2">
								<div>
									<a href="{{ url_for('edit_hike', hike_id=hike._id) }}"
										class="waves-effect waves-light btn btn_small edit_button">Edit</a>
									<a href="{{ url_for('delete_hike', hike_id=hike._id) }}"
										onclick="return confirm('Are you sure you want to delete this hike?');"
										class="waves-effect waves-light btn btn_small delete_button">Delete</a>
								</div>
							</div>
							<div class="task_header col s9 center-align">
								Town / City: <strong>{{hike.hike_region}}</strong>
								<p id="county" name="county_name">
									County: <strong>{{hike.county_name}}</strong>
								</p>
							</div>
							<div class="col s1">
								<i class="material-icons">expand_more</i>
							</div>
						</div>
						<div class="collapsible-body col s12">
							<div class="col s12 m6">
								<p>Difficulty: {{hike.hike_difficulty}}</p>
								<p>Hike Description / Directions: {{hike.hike_description}}</p>
								<p>Hike Duration: {{hike.hike_duration}}</p>
								<p>Hike Distance: {{hike.hike_distance}}</p>
								<p>Hike Name: {{hike.hike_name}}</p>
								<p>Hike Location: {{hike.hike_postcode}}</p>
								<p>Hike Attributes: 
                                    <ul>
                                    {% for attribute in hike.multiple_selction %}
                                        <li>{{ attribute }}</li>
                                    {% endfor %}
                                    </ul>
                                </p>
							</div>
							<div class="col s12 m6">
								<div id="{{hike.hike_name}}" class="maps zoomed_map"></div>
							</div>
						</div>
					</li>
				</ul>
			</div>
		</div>
		{% endfor %}
	</ul>
</div>

{% endblock %}

{% block js %}

<script>

	{% for hike in hikes %}


    	var marker = L.marker([{{hike.hike_coordinates}}]).addTo(map);

        console.log({{hike.hike_name}}) // undefined for each
        // console.log({{hike}}) // throws an error in console, Unexpected token '&'
        console.log({{hike.hike_coordinates}}) // working just fine though

        // console.log({{hike.multiple_selction}})

        // {$toString: {{hike.multiple_selction}}}


        var mapTileLayers{{hike.hike_name}} = L.tileLayer("http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}", {
            attribution: "Powered by <a href='https://developers.arcgis.com/terms/attribution/' target='_blank' rel='noopener'>Esri</a>"
        });
	
        var hikeName = {{hike.hike_name}};
        hikeName = L.map("{{hike.hike_name}}", {
            layers: [mapTileLayers{{hike.hike_name}}],
            center: [{{hike.hike_coordinates}}],
            zoom: 13
        });

    {% endfor %}

</script>

{% endblock %}

        <!-- function(coor) {var marker = L.marker([{{coor}}]).addTo(map);} -->